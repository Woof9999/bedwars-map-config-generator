<!DOCTYPE html>
<html>
<head>
    <title>Bedwars Map PHP Generator</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        h2 { margin-top: 40px; }
        .box { background: white; padding: 15px; margin-bottom: 15px; border-radius: 6px; }
        label { display: block; margin-top: 5px; }
        select, input { padding: 5px; margin-bottom: 5px; width: 230px; }
        button { margin-top: 10px; padding: 6px 10px; cursor: pointer; }
        textarea { width: 100%; height: 400px; font-family: monospace; }
    </style>
</head>
<body>

<h1>Bedwars Map PHP Generator</h1>

<div class="box">
    <label>Map Name:</label>
    <input id="mapName" placeholder="flowers" />

    <h3>Teams</h3>
    <div id="teams"></div>
    <button onclick="addTeam()">+ Add Team</button>

    <h3>Diamond Gens</h3>
    <div id="diamondGens"></div>
    <button onclick="addGen('diamondGens')">+ Add Diamond Gen</button>

    <h3>Emerald Gens</h3>
    <div id="emeraldGens"></div>
    <button onclick="addGen('emeraldGens')">+ Add Emerald Gen</button>

    <h3>Height Limit</h3>
    <input id="heightLimit" type="number" placeholder="116" />

    <br><br>
    <button onclick="generateCode()">Generate PHP Code</button>
</div>

<h2>Generated PHP</h2>
<textarea id="output"></textarea>

<script>
const teamColors = [
    "red", "green", "purple", "blue", "yellow", "pink", "gray", "orange"
];

function formatCoord(num) {
    if (!num) return "0.0";
    let n = parseFloat(num);
    if (isNaN(n)) return "0.0";
    return Number.isInteger(n) ? n.toFixed(1) : n;
}

function parseTriple(str) {
    let parts = str.trim().split(/\s+/).map(formatCoord);
    while (parts.length < 3) parts.push("0.0");
    return `new Vector3(${parts[0]}, ${parts[1]}, ${parts[2]})`;
}

function addTeam() {
    const div = document.createElement('div');
    div.className = 'box';
    div.innerHTML = `
        <label>Team Color:</label>
        <select class="teamColor">
            ${teamColors.map(c => `<option value="${c}">${c.charAt(0).toUpperCase() + c.slice(1)} Team</option>`).join('')}
        </select>
        <label>Generator (X Y Z):</label>
        <input class="generator" placeholder="0 0 0" />
        <label>Bed (X Y Z):</label>
        <input class="bed" placeholder="0 0 0" />
        <label>Spawn (X Y Z):</label>
        <input class="spawn" placeholder="0 0 0" />
    `;
    document.getElementById('teams').appendChild(div);
}

function addGen(type) {
    const div = document.createElement('div');
    div.innerHTML = `<input class="${type}" placeholder="X Y Z" />`;
    document.getElementById(type).appendChild(div);
}

function generateCode() {
    const mapName = document.getElementById('mapName').value;
    const heightLimit = document.getElementById('heightLimit').value || "0";

    let teamsDivs = document.querySelectorAll('#teams .box');
    let teamsCode = [];
    teamsDivs.forEach(team => {
        let color = team.querySelector('.teamColor').value;
        let gen = parseTriple(team.querySelector('.generator').value);
        let bed = parseTriple(team.querySelector('.bed').value);
        let spawn = parseTriple(team.querySelector('.spawn').value);

        teamsCode.push(
`array_merge([
    "generator" => ${gen},
    "bed" => ${bed},
    "spawn" => ${spawn}
], self::\$${color})`
        );
    });

    function genList(className) {
        let gens = [];
        document.querySelectorAll('.' + className).forEach(input => {
            if (input.value.trim()) gens.push(parseTriple(input.value));
        });
        return gens.join(',\n            ');
    }

    let code = `if ($map === "${mapName}") {
    return [
        "teams" => [
            ${teamsCode.join(",\n            ")}
        ],
        "diamondGens" => [
            ${genList('diamondGens')}
        ],
        "emeraldGens" => [
            ${genList('emeraldGens')}
        ],
        "heightLimit" => ${heightLimit},
    ];
}`;
    document.getElementById('output').value = code;
}
</script>
    
<script>
document.getElementById('convert').addEventListener('click', () => {
    const input = document.getElementById('coords').value.trim();
    const lines = input.split(/\n+/);

    const result = lines.map(line => {
        const parts = line.trim().split(/\s+/);
        if (parts.length === 3) {
            const x = roundToHalf(parseFloat(parts[0]));
            const y = roundToHalf(parseFloat(parts[1]));
            const z = roundToHalf(parseFloat(parts[2]));
            return `${x} ${y} ${z}`;
        }
        return line;
    }).join('\n');

    document.getElementById('output').value = result;
});

function roundToHalf(num) {
    return Math.round(num * 2) / 2;
}
</script>
    
</body>
</html>
